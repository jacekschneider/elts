#MACHINE = "raspberrypi4-64"

DL_DIR ?= "${TOPDIR}/downloads"
SSTATE_DIR ?= "${TOPDIR}/sstate-cache"
TMPDIR = "${TOPDIR}/tmp"

DISTRO ?= "poky"
EXTRA_IMAGE_FEATURES ?= "allow-empty-password empty-root-password allow-root-login"

BB_DISKMON_DIRS ??= "\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    STOPTASKS,/tmp,100M,100K \
    HALT,${TMPDIR},100M,1K \
    HALT,${DL_DIR},100M,1K \
    HALT,${SSTATE_DIR},100M,1K \
    HALT,/tmp,10M,1K"

BB_NUMBER_THREADS = "20"
PARALLEL_MAKE = "-j 20"


# added for TE0726-04-41C94-A module
MACHINE = "zynq-generic"

LICENSE_FLAGS_ACCEPTED += "xilinx"
XILINX_WITH_ESW = "std"
XILINX_RELEASE_VERSION = "v2024.2"

KERNEL_IMAGETYPES:append = " fitImage"
KERNEL_CLASSES:append = " kernel-fitimage"

INITRAMFS_IMAGE = "petalinux-image-minimal"
INITRAMFS_IMAGE_BUNDLE = "0"
IMAGE_FSTYPES:pn-petalinux-image-minimal = "cpio.gz"
IMAGE_INSTALL:remove:pn-petalinux-image-minimal = "kernel-modules"
IMAGE_INSTALL:remove:pn-petalinux-image-minimal = "nfs-utils nfs-utils-client meson"
EXTRA_IMAGE_FEATURES += "debug-tweaks"

INITRAMFS_IMAGE_NAME = "${INITRAMFS_IMAGE}-${MACHINE}"
PREFERRED_PROVIDER_virtual/dtb = "device-tree"

# TE0726-04-41C94-A prebuilt artifacts, generated by vivado tools
BITSTREAM_PATH = "${COREBASE}/../TE0726-04-41C94-A-prebuilt/hardware/zynqberrydemo_m_512MB.bit"
FSBL_FILE = "${COREBASE}/../TE0726-04-41C94-A-prebuilt/software/fsbl"